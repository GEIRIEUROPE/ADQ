This is python code for ADQ. 